<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£ | EmberğŸ</title><meta name="author" content="EmberğŸ"><meta name="copyright" content="EmberğŸ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MITï¼šxv6 chapter1"><meta property="og:type" content="article"><meta property="og:title" content="xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£"><meta property="og:url" content="http://www.ember-l.top/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%201%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/index.html"><meta property="og:site_name" content="EmberğŸ"><meta property="og:description" content="MITï¼šxv6 chapter1"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg"><meta property="article:published_time" content="2023-03-14T11:29:24.000Z"><meta property="article:modified_time" content="2023-09-26T10:58:55.719Z"><meta property="article:author" content="EmberğŸ"><meta property="article:tag" content="æ“ä½œç³»ç»Ÿ"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.ember-l.top/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%201%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"FNCTP04VYC",apiKey:"5edd8c47a13fcf53938686d6f1752dbb",indexName:"dev_blog",hits:{per_page:6},languages:{input_placeholder:"æœç´¢æ–‡ç« ",hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},localSearch:void 0,translate:void 0,noticeOutdate:{limitDay:365,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:{limitCount:50,languages:{author:"ä½œè€…: EmberğŸ",link:"é“¾æ¥: ",source:"æ¥æº: EmberğŸ",info:"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js",css:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-09-26 18:58:55"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/font.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/wave.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/progress_bar.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/readPercent.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3864328_90xjkz8cfrn.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><span id="fps"></span><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><link rel="stylesheet" href="/css/twikoo_beautify.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/tag.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/Swiper/8.0.6/swiper-bundle.min.css"><script data-pjax src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/Swiper/8.0.6/swiper-bundle.min.js"></script><link rel="stylesheet" href="/css/barrage.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><script src="/js/reward.js"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.16/dist/sweetalert2.all.min.js"></script><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"><style>#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before{content:"\A";white-space:pre}#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator{display:none}</style><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",(()=>{preloader.endLoading()})),document.addEventListener("pjax:send",(()=>{preloader.initLoading()})),document.addEventListener("pjax:complete",(()=>{preloader.endLoading()}))</script><link rel="stylesheet" href="/css/precess_bar.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/assets/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-SmartHome"></use></svg> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shuji"></use></svg> <span>æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zongheshuju"></use></svg> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fabu-"></use></svg> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg> <span>åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:randomPost();"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenxiang"></use></svg> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-meishikafei"></use></svg> <span>å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinle"></use></svg> <span>éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fabu-"></use></svg> <span>ç…§ç‰‡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-dianying"></use></svg> <span>ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijie"></use></svg> <span>ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg> <span>æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyan"></use></svg> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg> <span>å‹äººé“¾</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wangye"></use></svg> <span>å°ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg> <span>ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/article/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg> <span>æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingshalou"></use></svg> <span>ç”Ÿæ¶¯</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-food-doughnut"></use></svg> <span>å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">EmberğŸ</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-SmartHome"></use></svg> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shuji"></use></svg> <span>æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-zongheshuju"></use></svg> <span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fabu-"></use></svg> <span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg> <span>åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:randomPost();"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenxiang"></use></svg> <span>éšä¾¿é€›é€›</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-meishikafei"></use></svg> <span>å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinle"></use></svg> <span>éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fabu-"></use></svg> <span>ç…§ç‰‡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-dianying"></use></svg> <span>ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shijie"></use></svg> <span>ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pengyouquan"></use></svg> <span>æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyan"></use></svg> <span>ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg> <span>å‹äººé“¾</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-wangye"></use></svg> <span>å°ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/charts/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg> <span>ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/article/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg> <span>æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingshalou"></use></svg> <span>ç”Ÿæ¶¯</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-food-doughnut"></use></svg> <span>å…³äº</span></a></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:25px;width:25px;fill:currentColor;position:relative;top:2px;right:8px" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg> <span>æœç´¢</span></a></div><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:5px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-14T11:29:24.000Z" title="å‘è¡¨äº 2023-03-14 19:29:24">2023-03-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-09-26T10:58:55.719Z" title="æ›´æ–°äº 2023-09-26 18:58:55">2023-09-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">6604</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>24åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ç³»ç»Ÿè°ƒç”¨"><a href="#ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨"></a>ç³»ç»Ÿè°ƒç”¨</h1><p>åœ¨æ“ä½œç³»ç»Ÿçš„ç®€ä»‹ä¸­ï¼Œè¯´åˆ°ä¸ºäº†æ–¹ä¾¿ç¨‹åºä½¿ç”¨ç¡¬ä»¶èµ„æºæ“ä½œç³»ç»Ÿä¼šæä¾›ä¸€äº›åº”ç”¨æ¥å£ã€‚</p><p>å¦‚Figure1.1æ‰€ç¤ºï¼Œåœ¨xv6ä¸­é‡‡å–ä¸€ä¸ª<strong>å†…æ ¸(kernel)ç©ºé—´</strong>çš„è®¾è®¡ï¼šä¸€ä¸ªç‰¹æ®Šçš„ç¨‹åºæä¾›æœåŠ¡ç»™è¿è¡Œçš„ç¨‹åºã€‚æ¯ä¸ªè¿è¡Œçš„ç¨‹åºæˆ‘ä»¬ç§°ä½œä¸ºè¿›ç¨‹(Process)æ‹¥æœ‰æŒ‡ä»¤ã€æ•°æ®ã€æ ˆã€‚<strong>ç”¨æˆ·ç©ºé—´(user space)ï¼š</strong> æŠ½è±¡å‡ºçš„ä¸€ä¸ªç©ºé—´ï¼Œç”¨äºç”¨æˆ·è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå¦‚shell(æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ŒåŠŸèƒ½å°±æ˜¯è¯»å–å‘½ä»¤å¹¶æ‰§è¡Œ)ã€cat</p><ul><li>æŒ‡ä»¤(instruction)ï¼šå®ç°ç¨‹åºçš„è®¡ç®—</li><li>æ•°æ®(data)ï¼šä¸€äº›è®¡ç®—çš„å˜é‡</li><li>æ ˆ(stack)ï¼šç»„ç»‡çš„ç¨‹åº(Cè¯­è¨€ä¸­çš„å‡½æ•°)çš„è°ƒç”¨</li></ul><p>å½“è¿›ç¨‹è°ƒç”¨å†…æ ¸æœåŠ¡æ—¶æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œ(invoke)<strong>ç³»ç»Ÿè°ƒç”¨</strong>ï¼Œç³»ç»Ÿè°ƒç”¨ä¼šè¿›å…¥å†…æ ¸ï¼Œç„¶åå†…æ ¸æ‰§è¡ŒæœåŠ¡å¹¶è¿”å›ï¼Œäºæ˜¯è¿™æ ·çš„ä¸€ä¸ªè¿›ç¨‹ä¼šé€‰æ‹©åœ¨ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´æ‰§è¡Œã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/20230128013838.png" alt="image.png"></p><h1 id="è¿›ç¨‹ä¸å†…å­˜"><a href="#è¿›ç¨‹ä¸å†…å­˜" class="headerlink" title="è¿›ç¨‹ä¸å†…å­˜"></a>è¿›ç¨‹ä¸å†…å­˜</h1><h2 id="è¿›ç¨‹-Process-ï¼š"><a href="#è¿›ç¨‹-Process-ï¼š" class="headerlink" title="è¿›ç¨‹(Process)ï¼š"></a>è¿›ç¨‹(Process)ï¼š</h2><blockquote><p>è¿›ç¨‹çš„æ¦‚å¿µï¼šè¿›ç¨‹ç®€å•æ¥è¯´å°±æ˜¯æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œä¾‹å¦‚æˆ‘ä»¬ä»¥åŠå¯åŠ¨çš„wordåŠå…¬è½¯ä»¶ã€æ¸¸æˆåº”ç”¨ç­‰åº”ç”¨ç¨‹åºã€‚</p></blockquote><p>æˆ‘ä»¬ä¸ºäº†å®ç°ä¸€ä¸ªç³»ç»Ÿèƒ½å¤ŸåŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œç³»ç»Ÿéœ€è¦æä¾›ä¸€ç§æ‹¥æœ‰å¤šä¸ªCPUçš„å‡è±¡ï¼Œç§°ä½œä¸º<strong>è™šæ‹ŸåŒ–CPU</strong></p><p>é‚£ä¸ºäº†å®ç°è¿™ç§æŠ€æœ¯æˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§å«åš<strong>æ—¶åˆ†(time sharing)</strong> çš„CPUæŠ€æœ¯ï¼šä¸€ä¸ªè¿›ç¨‹åªä¼šè¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œä¹‹åä¾¿åˆ‡æ¢åˆ°å…¶ä»–è¿›ç¨‹ï¼Œä»è€Œæä¾›å¤šä¸ªCPUçš„å‡è±¡ã€‚</p><p>è¿›ç¨‹ä¹‹é—´çš„åˆ‡æ¢ç§°ä½œä¸ºä¸Šä¸‹æ–‡åˆ‡æ¢(context switch).</p><h2 id="è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ï¼šxv6"><a href="#è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ï¼šxv6" class="headerlink" title="è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ï¼šxv6"></a>è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ï¼šxv6</h2><p>è¿›ç¨‹APIè®¾è®¡æ‰€éœ€è¦åŒ…å«çš„å†…å®¹</p><ul><li>åˆ›å»ºï¼ˆcreateï¼‰ï¼šæ“ä½œç³»ç»Ÿå¿…é¡»åŒ…å«ä¸€äº›åˆ›å»ºæ–°è¿›ç¨‹çš„æ–¹æ³•ã€‚åœ¨ shell ä¸­é”®å…¥å‘½ä»¤æˆ–åŒå‡»åº”ç”¨ç¨‹åºå›¾æ ‡æ—¶ï¼Œä¼šè°ƒç”¨æ“ä½œç³»ç»Ÿæ¥åˆ›å»ºæ–°è¿›ç¨‹ï¼Œè¿è¡ŒæŒ‡å®šçš„ç¨‹åºã€‚</li><li>é”€æ¯ï¼ˆdestroyï¼‰ï¼šç”±äºå­˜åœ¨åˆ›å»ºè¿›ç¨‹çš„æ¥å£ï¼Œå› æ­¤ç³»ç»Ÿè¿˜æä¾›äº†ä¸€ä¸ªå¼ºåˆ¶é”€æ¯è¿›ç¨‹çš„æ¥å£ã€‚</li><li>ç­‰å¾…ï¼ˆwaitï¼‰ï¼šæœ‰æ—¶ç­‰å¾…è¿›ç¨‹åœæ­¢è¿è¡Œæ˜¯æœ‰ç”¨çš„ï¼Œå› æ­¤ç»å¸¸æä¾›æŸç§ç­‰å¾…æ¥å£ã€‚</li><li>å…¶ä»–æ§åˆ¶ï¼ˆmiscellaneous controlï¼‰ï¼šé™¤äº†æ€æ­»æˆ–ç­‰å¾…è¿›ç¨‹å¤–ï¼Œæœ‰æ—¶è¿˜å¯èƒ½æœ‰å…¶ä»–æ§åˆ¶ã€‚</li><li>çŠ¶æ€ï¼ˆstatusï¼‰ï¼šé€šå¸¸ä¹Ÿæœ‰ä¸€äº›æ¥å£å¯ä»¥è·å¾—æœ‰å…³è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ã€‚</li></ul><div class="table-container"><table><thead><tr><th>ç³»ç»Ÿè°ƒç”¨</th><th>æè¿°</th></tr></thead><tbody><tr><td>int <code>exit(int status)</code></td><td>ä¸­æ­¢å½“å‰è¿›ç¨‹ï¼Œå°†çŠ¶æ€æŠ¥å‘Šç»™wait(),æ²¡æœ‰è¿”å›</td></tr><tr><td>int <code>getpid()</code></td><td>è¿”å›å½“å‰è¿›ç¨‹çš„PID</td></tr><tr><td>int <code>fork()</code></td><td>åˆ›å»ºè¿›ç¨‹ï¼Œè¿”å›å­è¿›ç¨‹çš„PID</td></tr><tr><td>int <code>wait(int *status)</code></td><td>çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹é€€å‡º(exit);é€€å‡ºçŠ¶æ€æ˜¯<code>*Status</code>ï¼Œè¿”å›å€¼ä¸ºå­è¿›ç¨‹çš„PID</td></tr><tr><td>int <code>sleep(int n)</code></td><td>æš‚åœè¿›ç¨‹nä¸ªæ—¶é’Ÿticksçš„æ—¶é—´</td></tr><tr><td>int exec<code>(char *file, char *argv[])</code></td><td>åŠ è½½æ–‡ä»¶<code>(*file)</code>æ‰§è¡Œï¼Œä»¥å…¶å‚æ•°<code>(*argv)</code>æ‰§è¡Œç¨‹åºï¼Œé”™è¯¯åè¿”å›-1</td></tr><tr><td>int <code>kill(int pid)</code></td><td>ä¸­æ­¢è¿›ç¨‹å·ä¸ºPIDçš„è¿›ç¨‹ï¼ŒæˆåŠŸè¿”å›0ï¼Œé”™è¯¯è¿”å›-1</td></tr><tr><td>char <code>*sbrk(int n)</code></td><td>å¢åŠ å½“å‰è¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œå¹¶è¿”å›æ–°å†…å­˜çš„å¼€å§‹ä½ç½®</td></tr></tbody></table></div><h2 id="åº”ç”¨ç¤ºä¾‹"><a href="#åº”ç”¨ç¤ºä¾‹" class="headerlink" title="åº”ç”¨ç¤ºä¾‹"></a>åº”ç”¨ç¤ºä¾‹</h2><ol><li><p>åˆ›å»º<br>ä½¿ç”¨<code>fork()</code>ç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥åˆ›å»ºè¿›ç¨‹ï¼Œæ–°åˆ›å»ºçš„è¿›ç¨‹(child)ä¼šå¤åˆ¶å½“å‰è¿›ç¨‹(parent)çš„å†…å­˜(æ•°æ®ä¸æŒ‡ä»¤)ã€‚<code>fork()</code>åˆ›å»ºè¿›ç¨‹æˆåŠŸå(ä¸åŒçš„è¿›ç¨‹çš„PIDä¸ä¼šç›¸åŒ)ï¼Œå­è¿›ç¨‹çš„è¿”å›å€¼ä¸º0ï¼Œçˆ¶è¿›ç¨‹çš„è¿”å›å€¼ä¸ºå­è¿›ç¨‹çš„PID</p></li><li><p>é€€å‡ºâ€”-å…¶ä»–æ§åˆ¶<br>ä½¿ç”¨<code>exit()</code>ç³»ç»Ÿè°ƒç”¨ï¼Œä¼šå¯¼è‡´è°ƒç”¨å®ƒçš„è¿›ç¨‹åœæ­¢è¿è¡Œï¼Œå¹¶ä¸”é‡Šæ”¾è¯¸å¦‚å†…å­˜å’Œæ‰“å¼€æ–‡ä»¶åœ¨å†…çš„èµ„æºã€‚</p></li><li><p>ç­‰å¾…<br>ä½¿ç”¨<code>wait()</code>ç³»ç»Ÿè°ƒç”¨ï¼Œä¼šè¿”å›ä¸€ä¸ªå½“å‰è¿›ç¨‹å·²é€€å‡ºçš„å­è¿›ç¨‹ï¼Œå¦‚æœæ²¡æœ‰å­è¿›ç¨‹é€€å‡ºï¼Œwait ä¼šç­‰å€™ç›´åˆ°æœ‰ä¸€ä¸ªå­è¿›ç¨‹é€€å‡ºã€‚å¦‚æœè°ƒç”¨è¯¥æ¥å£çš„è¿›ç¨‹æ²¡æœ‰å­è¿›ç¨‹ï¼Œä¼šè¿”å›-1ï¼Œå½“æˆ‘ä»¬ä¸åœ¨æ„å­è¿›ç¨‹çš„çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥0å»ç­‰å¾…ã€‚</p></li></ol><p>è§‚çœ‹ä¸‹è¿°ä»£ç ç¤ºä¾‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> pid = fork();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(pid &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;parent: child=%d\n&quot;</span>, pid);</span><br><span class="line">    pid = wait((<span class="type">int</span> *) <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;child %d is done\n&quot;</span>, pid);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(pid == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;child: exiting\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;fork error\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­çš„è¿è¡Œç»“æœä¸º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parent: child=32381</span><br><span class="line">child: exiting</span><br><span class="line">//è¿™æ¡è¯­å¥æ˜¯ç­‰å¾…å­è¿›ç¨‹é€€å‡ºåæ‰ä¼šæ‰§è¡Œ</span><br><span class="line">child 32381 is done</span><br></pre></td></tr></table></figure><blockquote><p><strong>NOTE:</strong> è™½ç„¶æˆ‘ä»¬çˆ¶å­è¿›ç¨‹åœ¨åˆå§‹åŒ–æ—¶ä¼šæœ‰ç›¸åŒçš„å†…å­˜ï¼Œä½†æ˜¯åœ¨ä¹‹åï¼Œä»–ä»¬ä¼šæœ‰å•ç‹¬çš„å¯„å­˜å™¨ä¸å†…å­˜ï¼Œä¸¤ä¸ªè¿›ç¨‹çš„å˜é‡å½¼æ­¤äº’ä¸å¹²æ‰°ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå˜é‡PIDï¼Œçˆ¶è¿›ç¨‹ä¸­PID = 32381ï¼Œè€Œå­è¿›ç¨‹çš„PID = 0</p></blockquote><ol><li>æ‰§è¡Œæ–‡ä»¶<br>ä½¿ç”¨execç³»ç»Ÿè°ƒç”¨ ï¼Œå°†ä»æŸä¸ªæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰é‡Œè¯»å–å†…å­˜é•œåƒï¼Œå¹¶å°†å…¶æ›¿æ¢åˆ°è°ƒç”¨å®ƒçš„è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€‚</li></ol><p>ç¤ºä¾‹ï¼šè¿™æ®µä»£ç å°†è°ƒç”¨ç¨‹åºæ›¿æ¢ä¸º /bin/echo è¿™ä¸ªç¨‹åºï¼Œè¿™ä¸ªç¨‹åºçš„å‚æ•°åˆ—è¡¨ä¸ºecho helloã€‚å¤§éƒ¨åˆ†çš„ç¨‹åºéƒ½å¿½ç•¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æƒ¯ä¾‹ä¸Šæ˜¯ç¨‹åºçš„åå­—ï¼ˆæ­¤ä¾‹æ˜¯ echoï¼‰ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *argv[<span class="number">3</span>];</span><br><span class="line">argv[<span class="number">0</span>] = <span class="string">&quot;echo&quot;</span>;</span><br><span class="line">argv[<span class="number">1</span>] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">argv[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">exec(<span class="string">&quot;/bin/echo&quot;</span>, argv);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;exec error\n&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p><strong>xv6ï¼š</strong> user/sh.cä¸­æˆ‘ä»¬ä¼šå¼€å¯ä¸€ä¸ªæ­»å¾ªç¯è¿›è¡Œè¯»å–ç”¨æˆ·çš„è¾“å…¥ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œå°†è§£æå®Œæˆçš„å‚æ•°ï¼Œä¼ é€’ç»™runcmd()å‡½æ•°å»è°ƒç”¨exceæ‰§è¡Œç¨‹åº(echoç¨‹åº)ï¼Œwaitæ˜¯ä¸»ç¨‹åºéœ€è¦ç­‰å¾…få­è¿›ç¨‹çš„é€€å‡ºã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(getcmd(buf, <span class="keyword">sizeof</span>(buf)) &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(buf[<span class="number">0</span>] == <span class="string">&#x27;c&#x27;</span> &amp;&amp; buf[<span class="number">1</span>] == <span class="string">&#x27;d&#x27;</span> &amp;&amp; buf[<span class="number">2</span>] == <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">    <span class="comment">// Chdir must be called by the parent, not the child.</span></span><br><span class="line">    buf[<span class="built_in">strlen</span>(buf)<span class="number">-1</span>] = <span class="number">0</span>;  <span class="comment">// chop \n</span></span><br><span class="line">    <span class="comment">//+3(&quot;cd &quot;) meanning skip to the string for dir</span></span><br><span class="line">    <span class="keyword">if</span>(chdir(buf+<span class="number">3</span>) &lt; <span class="number">0</span>)</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;cannot cd %s\n&quot;</span>, buf+<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(fork1() == <span class="number">0</span>)</span><br><span class="line">    runcmd(parsecmd(buf));</span><br><span class="line">  wait(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xv6 é€šå¸¸éšå¼åœ°åˆ†é…ç”¨æˆ·çš„å†…å­˜ç©ºé—´ã€‚fork åœ¨å­è¿›ç¨‹éœ€è¦è£…å…¥çˆ¶è¿›ç¨‹çš„å†…å­˜æ‹·è´æ—¶åˆ†é…ç©ºé—´ï¼Œexec åœ¨éœ€è¦è£…å…¥å¯æ‰§è¡Œæ–‡ä»¶æ—¶åˆ†é…ç©ºé—´ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨éœ€è¦é¢å¤–å†…å­˜æ—¶å¯ä»¥é€šè¿‡è°ƒç”¨ sbrk(n) æ¥å¢åŠ  n å­—èŠ‚çš„æ•°æ®å†…å­˜ã€‚ sbrk è¿”å›æ–°çš„å†…å­˜çš„åœ°å€ã€‚</p><h2 id="è¿›ç¨‹åˆ›å»º-ç»†èŠ‚"><a href="#è¿›ç¨‹åˆ›å»º-ç»†èŠ‚" class="headerlink" title="è¿›ç¨‹åˆ›å»º(ç»†èŠ‚)"></a>è¿›ç¨‹åˆ›å»º(ç»†èŠ‚)</h2><ol><li>å°†ä»£ç å’Œé™æ€æ•°æ®(åˆå§‹åŒ–å˜é‡)åŠ è½½åˆ°å†…å­˜ï¼Œå†åŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚(æ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜ç¨‹åºå­—èŠ‚ï¼Œå¹¶å°†å…¶è¯»å…¥åˆ°å†…å­˜ä¸­)</li><li>ä¸ºç¨‹åºè¿è¡ŒæœŸæ ˆ(run-time stack)åˆ†é…å†…å­˜ï¼Œåœ¨Cè¯­è¨€ä¸­æˆ‘ä»¬ä½¿ç”¨æ ˆæ¥å­˜æ”¾å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›åœ°å€ã€‚æ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨å‚æ•°æ¥åˆå§‹åŒ–æ ˆï¼Œä¾‹å¦‚åœ¨linuxä¸­æˆ‘ä»¬å°†argcã€argvå‚æ•°å¡«å…¥mainä¸­</li><li>ä¸ºç¨‹åºçš„å †(heap)åˆ†é…å†…å­˜ï¼Œå¦‚Cè¯­è¨€ä¸­ä½¿ç”¨mallocä¸freeï¼Œç”³è¯·ä¸é‡Šæ”¾çš„å†…å­˜ä¸ºå †å†…å­˜ã€‚æ³¨ï¼šå †å†…å­˜è¿œå¤§äºæ ˆå†…å­˜ï¼Œå› æ­¤ä¸€äº›å¤§å‹æ•°æ®ç»“æ„éœ€è¦ä½¿ç”¨å †æ¥ç”³è¯·å†…å­˜ã€‚</li><li>æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚ä¸€äº›IOæ“ä½œã€‚åœ¨unixä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹é»˜è®¤æƒ…å†µéƒ½ä¼šæ‰“å¼€3ä¸ªæ–‡ä»¶æè¿°ç¬¦(file descriptorï¼Œä¸€ä¸ªæ•´æ•°å¥æŸ„)ï¼Œç”¨äºæ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯ã€‚</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/20230129133311.png" alt="OSTEP4.1"></p><h2 id="è¿›ç¨‹çš„æ•°æ®ç»“æ„-xv6"><a href="#è¿›ç¨‹çš„æ•°æ®ç»“æ„-xv6" class="headerlink" title="è¿›ç¨‹çš„æ•°æ®ç»“æ„(xv6)"></a>è¿›ç¨‹çš„æ•°æ®ç»“æ„(xv6)</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Saved registers for kernel context switches.</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">context</span> &#123;</span></span><br><span class="line">  uint64 ra;</span><br><span class="line">  uint64 sp;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// callee-saved</span></span><br><span class="line">  uint64 s0;</span><br><span class="line">  uint64 s1;</span><br><span class="line">  uint64 s2;</span><br><span class="line">  uint64 s3;</span><br><span class="line">  uint64 s4;</span><br><span class="line">  uint64 s5;</span><br><span class="line">  uint64 s6;</span><br><span class="line">  uint64 s7;</span><br><span class="line">  uint64 s8;</span><br><span class="line">  uint64 s9;</span><br><span class="line">  uint64 s10;</span><br><span class="line">  uint64 s11;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">procstate</span> &#123;</span> UNUSED, USED, SLEEPING, RUNNABLE, RUNNING, ZOMBIE &#125;;</span><br><span class="line"><span class="comment">// Per-process state</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">proc</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">spinlock</span> <span class="title">lock</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// p-&gt;lock must be held when using these:</span></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">procstate</span> <span class="title">state</span>;</span>        <span class="comment">// Process state</span></span><br><span class="line">  <span class="type">void</span> *chan;                  <span class="comment">// If non-zero, sleeping on chan</span></span><br><span class="line">  <span class="type">int</span> killed;                  <span class="comment">// If non-zero, have been killed</span></span><br><span class="line">  <span class="type">int</span> xstate;                  <span class="comment">// Exit status to be returned to parent&#x27;s wait</span></span><br><span class="line">  <span class="type">int</span> pid;                     <span class="comment">// Process ID</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// wait_lock must be held when using this:</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">proc</span> *<span class="title">parent</span>;</span>         <span class="comment">// Parent process</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// these are private to the process, so p-&gt;lock need not be held.</span></span><br><span class="line">  uint64 kstack;               <span class="comment">// Virtual address of kernel stack</span></span><br><span class="line">  uint64 sz;                   <span class="comment">// Size of process memory (bytes)</span></span><br><span class="line">  <span class="type">pagetable_t</span> pagetable;       <span class="comment">// User page table</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">trapframe</span> *<span class="title">trapframe</span>;</span> <span class="comment">// data page for trampoline.S</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">context</span> <span class="title">context</span>;</span>      <span class="comment">// swtch() here to run process</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">file</span> *<span class="title">ofile</span>[<span class="title">NOFILE</span>];</span>  <span class="comment">// Open files</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">cwd</span>;</span>           <span class="comment">// Current directory</span></span><br><span class="line">  <span class="type">char</span> name[<span class="number">16</span>];               <span class="comment">// Process name (debugging)</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="I-O-ä¸-æ–‡ä»¶æè¿°ç¬¦"><a href="#I-O-ä¸-æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="I/O ä¸ æ–‡ä»¶æè¿°ç¬¦"></a>I/O ä¸ æ–‡ä»¶æè¿°ç¬¦</h1><h2 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h2><ul><li><strong>I/Oï¼š</strong> è¾“å…¥(input)ä¸è¾“å‡º(output),Cè¯­è¨€çš„å¤´æ–‡ä»¶<code>&lt;stdio.h&gt;</code>,ä»£è¡¨çš„å°±æ˜¯æ ‡å‡†è¾“å…¥ä¸è¾“å‡º</li><li><strong>æ–‡ä»¶æè¿°ç¬¦ï¼š</strong> file descriptorï¼Œç”¨ä¸€ä¸ªæ•´æ•°æ¥è¡¨ç¤ºå†…æ ¸ç®¡ç†çš„å¯¹è±¡ï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡è¯¥æè¿°ç¬¦è¿›è¡Œè¯»æˆ–å†™ï¼Œæ–‡ä»¶æè¿°ç¬¦æ¥å£å°†è¿™äº›æ–‡ä»¶ã€ç®¡é“ã€è®¾å¤‡æŠ½è±¡ä¸ºå­—èŠ‚æµ</li></ul><blockquote><p><strong>è·å¾—æ–‡ä»¶æè¿°ç¬¦(fd)</strong>,å¯ä»¥é€šè¿‡æ‰“å¼€æ–‡ä»¶ã€ç›®å½•ã€æˆ–è®¾å¤‡ã€åˆ›å»ºä¸€ä¸ªç®¡é“(Pipe)ã€é€šè¿‡å¤åˆ¶(duplicate)å·²ç»å­˜åœ¨çš„æ–‡ä»¶æè¿°ç¬¦</p></blockquote><ul><li><strong>è¿›ç¨‹è¡¨ï¼š</strong> åœ¨xv6ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªè¿›ç¨‹è¡¨ï¼Œè€Œæ–‡ä»¶æè¿°ç¬¦å°±æ˜¯ä½œä¸ºå…¶ä¸­çš„ä¸€ä¸ªç´¢å¼•ã€‚å› æ­¤æ¯ä¸ªè¿›ç¨‹çš„ç§æœ‰ç©ºé—´å†…çš„æ–‡ä»¶æè¿°ç¬¦éƒ½æ˜¯ä»¥0å¼€å§‹ã€‚</li></ul><p>åœ¨xv6ä¸­ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿›ç¨‹ä¼šé»˜è®¤å®šä¹‰äº†3ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</p><ul><li>æ ‡å‡†è¾“å…¥ï¼š0ï¼Œå°†fd=0æ–‡ä»¶çš„å†…å®¹è¿›è¡Œè¯»å–ï¼Œä¹Ÿå°±æ˜¯è¯»å–å‘½ä»¤è¡Œçš„å†…å®¹ï¼Œç­‰åŒäºCè¯­è¨€ä¸­çš„stdin</li><li>æ ‡å‡†è¾“å‡ºï¼š1ï¼Œå°†å†…å®¹è¾“å‡ºå†™å…¥åˆ°fd=1çš„æ–‡ä»¶ä¸­ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºå†…å®¹åˆ°å‘½ä»¤è¡Œï¼Œç­‰åŒäºstdout</li><li>é”™è¯¯ä¿¡æ¯ï¼š2ï¼Œå°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°fd=2çš„æ–‡ä»¶ä¸­ï¼Œç­‰åŒäºstderr</li></ul><blockquote><p>fd = 0,1,2ï¼Œè¿™ä¸‰ä¸ªæè¿°ç¬¦å¼•ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªæ–‡ä»¶<strong>console</strong>ï¼Œç›¸å½“äºå¤åˆ¶(duplicate)çš„æ“ä½œï¼Œå°†ä¸‰ä¸ªæè¿°ç¬¦ç”¨äºä¸åŒçš„è·¯å¾„ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>((fd = open(<span class="string">&quot;console&quot;</span>, O_RDWR)) &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span>(fd &gt;= <span class="number">3</span>)&#123;<span class="comment">//æˆ‘ä»¬ä¼šé™†ç»­è·å¾—åˆ°0ï¼Œ1ï¼Œ2ä¸‰ä¸ªæè¿°ï¼Œä¸º3æ—¶ç ´é™¤å¾ªç¯</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="I-Oç³»ç»Ÿè°ƒç”¨ï¼šxv6"><a href="#I-Oç³»ç»Ÿè°ƒç”¨ï¼šxv6" class="headerlink" title="I/Oç³»ç»Ÿè°ƒç”¨ï¼šxv6"></a>I/Oç³»ç»Ÿè°ƒç”¨ï¼šxv6</h2><div class="table-container"><table><thead><tr><th>ç³»ç»Ÿè°ƒç”¨</th><th>æè¿°</th></tr></thead><tbody><tr><td>int <code>open(char *file, int flags)</code></td><td>æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼ŒæŒ‡å®šè¯»å†™çš„æ ‡è¯†(flag),è¿”å›æ–‡ä»¶æè¿°ç¬¦</td></tr><tr><td>int <code>write(int fd, char *buf, int n)</code></td><td>å°†bufçš„å†…å®¹å†™å…¥fdå¼•ç”¨çš„æ–‡ä»¶ï¼Œè¿”å›å€¼ä¸ºn</td></tr><tr><td>int <code>read(int fd, char *buf, int n)</code></td><td>å°†fdçš„æ–‡ä»¶å†…å®¹è¯»å–åˆ°bufä¸­ï¼Œè¿”å›è¯»å–çš„æ•°é‡ï¼Œå¦‚æœä¸º0è¿™ä»£è¡¨EOF</td></tr><tr><td>int <code>close(int fd)</code></td><td>é‡Šæ”¾æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼ŒåŒ…æ‹¬openã€pipeã€dupæ‰€äº§ç”Ÿçš„fdï¼Œé‡Šæ”¾åå¯ä»¥å¤ç”¨è¯¥fd</td></tr><tr><td>int <code>dup(int fd)</code></td><td>è¿”å›ä¸€ä¸ªæ–°çš„æè¿°ç¬¦å¹¶å¼•ç”¨ä¸fdç›¸åŒçš„æ–‡ä»¶</td></tr><tr><td>int <code>pipe(int p[])</code></td><td>åˆ›å»ºç®¡é“ï¼Œå°†æ ‡å‡†è¾“å…¥è¾“å‡ºæè¿°ç¬¦æ”¾å…¥<code>p[0]</code>ã€<code>p[1]</code>ä¸­</td></tr></tbody></table></div><blockquote><p>open()æ¥å£çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ ‡è¯†ç¬¦(æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼)ï¼š</p></blockquote><ul><li>O_RDONLYï¼šåªè¯»</li><li>O_WRONLYï¼šåªå†™</li><li>O_RDWRï¼šè¯»å†™</li><li>O_CREATEï¼šæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ–°å»ºæ–‡ä»¶</li><li>O_TRUNCï¼šæˆªæ–­ï¼Œå°†æ–‡ä»¶å†…å®¹æ¸…é™¤</li></ul><h2 id="åº”ç”¨ç¤ºä¾‹-1"><a href="#åº”ç”¨ç¤ºä¾‹-1" class="headerlink" title="åº”ç”¨ç¤ºä¾‹"></a>åº”ç”¨ç¤ºä¾‹</h2><ul><li><p>catåº”ç”¨ï¼šæ–‡ä»¶ä½ç½®user/cat.cï¼Œæˆ‘ä»¬å°†openã€readã€writeä¸‰ä¸ªç³»ç»Ÿæ¥å£æ¥å£èšåˆå½¢æˆäº†catè¿™ä¸ªæ‰“å°æ–‡ä»¶å†…å®¹çš„ç¨‹åºã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> buf[<span class="number">512</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *agrv[])</span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; argc; i++)&#123;</span><br><span class="line">  <span class="keyword">if</span>((fd = open(argv[i], <span class="number">0</span>)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;cat: cannot open %s\n&quot;</span>, argv[i]);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  cat(fd);</span><br><span class="line">  close(fd);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure></li></ul><p>void cat(int fd){<br>â€¦<br>while((n = read(fd, buf, sizeof(buf))) &gt; 0) {<br>if (write(1, buf, n) != n) {<br>fprintf(2, â€œcat: write error\nâ€);<br>exit(1);<br>}<br>}<br>â€¦<br>}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨catæ‰“å°hello.txtï¼Œæ–‡ä»¶å†…å®¹ä¸ºhello world!</span><br><span class="line">```shell</span><br><span class="line">cat hello.txt</span><br></pre></td></tr></table></figure><ol><li>é¦–å…ˆåœ¨mainä¸­ä½¿ç”¨openæ‰“å¼€hello.txtï¼Œç¬¬äºŒä¸ªå‚æ•°0ä»£è¡¨åªè¯»(kernel / fctrl.c)ä¸­å®šä¹‰äº†O_RDONLYä¸º0x000</li><li>ç„¶åå°†æ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™catå‡½æ•°ï¼Œæ ¹æ®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨readæ¥å£è¯»å–hello.txtçš„å†…å®¹</li><li>æœ€åå†é€šè¿‡writeå°†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå†™å…¥åˆ°æ ‡å‡†è¾“å‡ºä¸­</li></ol><h2 id="I-Oé‡å®šå‘"><a href="#I-Oé‡å®šå‘" class="headerlink" title="I/Oé‡å®šå‘"></a>I/Oé‡å®šå‘</h2><blockquote><p><strong>I/Oé‡å®šå‘ï¼š</strong> é€šå¸¸æƒ…å†µæˆ‘ä»¬éƒ½æ˜¯å°†å†…å®¹è¾“å‡ºåˆ°å±å¹•ä¹Ÿå°±æ˜¯å‘½ä»¤è¡Œï¼Œé€šè¿‡I/Oé‡å®šå‘ä¾¿å¯ä»¥å°†å†…å®¹è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶å†…ã€‚<strong>I/Oçš„é‡å®šå‘</strong> = å°†æ ‡å‡†è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯ä¿¡æ¯æ‰“å°ï¼Œä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦æ›¿æ¢ï¼Œä½œä¸ºæŒ‡å®šæ–‡ä»¶çš„æè¿°ç¬¦</p></blockquote><p>linuxä¸‹çš„é‡å®šå‘ç¬¦å·ä½¿ç”¨</p><ul><li><code>å‘½ä»¤ &gt; æ–‡ä»¶</code>ï¼šå°†å†…å®¹è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</li><li><code>å‘½ä»¤ 2&gt; æ–‡ä»¶</code>,å¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</li><li><code>å‘½ä»¤ &gt;&gt; æ–‡ä»¶</code>ï¼šä»¥è¿½åŠ çš„å½¢å¼è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</li><li><p><code>å‘½ä»¤ &gt; æ–‡ä»¶ 2&gt;&amp;1</code>ï¼šå°†æ ‡å‡†è¾“å‡ºäºé”™è¯¯æ¶ˆæ¯è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼Œåœ¨åç»­å°†ä¼šä½¿ç”¨åˆ°è¯¥ç¬¦å·ï¼Œç­‰åŒäº<code>å‘½ä»¤ &amp;&gt; æ–‡ä»¶</code>ã€‚ä¸ªäººç†è§£:&amp;ä½œä¸ºå¼•ç”¨ç›¸å½“äºduplicateï¼Œfd=2ä½œä¸ºä¸€ä¸ªfd=1çš„å‰¯æœ¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> a b &gt; tmp1 2&gt;&amp;1 <span class="comment">#bç›®å½•ä¸å­˜åœ¨,å°†2(æ ‡å‡†é”™è¯¯æ‰“å°)é‡å®šå‘1(æ ‡å‡†è¾“å‡º)</span></span></span><br></pre></td></tr></table></figure></li><li><code>å‘½ä»¤ &lt; æ–‡ä»¶</code>ï¼šå°†æ–‡ä»¶å†…å®¹è¾“å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œå°†æ–‡ä»¶å†…å®¹ä½œä¸ºå‘½ä»¤çš„æ ‡å‡†è¾“å…¥</li><li><code>å‘½ä»¤ &lt; æ–‡ä»¶1 &gt; æ–‡ä»¶2</code>ï¼šå°†æ–‡ä»¶1ä½œä¸ºå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼Œå¹¶å°†æ ‡å‡†è¾“å‡ºåˆ°æ–‡ä»¶2</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">----æ‰“å°åˆ°å±å¹•ä¸Š----</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello world!</span></span><br><span class="line">----å†™å…¥hello.txtæ–‡ä»¶ä¸­----</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello world! &gt; hello.txt</span></span><br><span class="line">----ä½¿ç”¨é‡å®šå‘æ¸…ç©ºæ–‡ä»¶å†…å®¹,åŸç†æ˜¯å°†ç©ºå†…å®¹è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶å†…----</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">: &gt; hello.txt <span class="comment"># or true &gt; hello.txt</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /dev/null &gt; hello.txt</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &gt; hello.txt</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>å®ç°ï¼š</strong> <code>fork()</code> + æ–‡ä»¶æè¿°ç¬¦</p></blockquote><p>åœ¨è¿›ç¨‹è®²è§£ä¸­æˆ‘ä»¬çŸ¥é“äº†ï¼Œforkç”Ÿæˆçš„å­è¿›ç¨‹ä¼šæ‹·è´çˆ¶è¿›ç¨‹çš„å†…å­˜ï¼Œé‚£ä¹ˆçˆ¶è¿›ç¨‹çš„æè¿°ç¬¦åŒæ ·ä¼šæ‹·è´åˆ°å­è¿›ç¨‹ã€‚<code>exec()</code>ç³»ç»Ÿè°ƒç”¨å°†ä¼šæ›¿ä»£è°ƒç”¨è¿›ç¨‹çš„å†…å­˜(åç»­ä¸å†æ‰§è¡Œè¯¥è¿›ç¨‹)ï¼Œä½†æ˜¯ä¼šä¿ç•™æ–‡ä»¶è¡¨ã€‚</p><blockquote><p><strong>æ‰©å±•ï¼š</strong> åœ¨å‘½ä»¤è¡Œé”®å…¥<code>cat</code>ï¼Œä¸åŠ ä¸Šæ–‡ä»¶åã€‚catä¼šé‡‡ç”¨æ ‡å‡†è¾“å…¥(fd=0)ä½œä¸ºè¾“å…¥æµè¿è¡Œç¨‹åºã€‚é”®å…¥<code>cat</code>åï¼Œcatç¨‹åºä¼šä¸€ç›´å ç”¨æ ‡å‡†è¾“å…¥ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€è¡Œå‘½ä»¤ï¼Œå°±ä¼šè¾“å‡ºä¸€è¡Œå‘½ä»¤ã€‚</p></blockquote><p>ç”±äºæ‰€æœ‰è¿›ç¨‹é»˜è®¤æ‰“å¼€äº†ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦0ï¼Œ1ï¼Œ2ã€‚å› æ­¤ä½¿ç”¨openæ‰“å¼€æ–‡ä»¶çš„è¿”å›å€¼æ˜¯3ã€‚è¦æƒ³å•ä¸ªcatå‘½ä»¤èƒ½å¤Ÿè·å–æ–‡ä»¶å†…å®¹ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨IOé‡å®šå‘ã€‚é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡ä½¿ç”¨fork+execä¸¤ä¸ªæ¥å£æ¥å®ç°é‡å®šå‘ï¼Œä»¥<code>cat &lt; input.txt</code>ä¸ºä¾‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> *argv[<span class="number">2</span>];</span><br><span class="line">    argv[<span class="number">0</span>] = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">    argv[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">        close(<span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> fd = open(<span class="string">&quot;input.txt&quot;</span>, O_RDONLY);</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>,<span class="string">&quot;fd = %d\n&quot;</span>,fd);</span><br><span class="line">        execvp( <span class="string">&quot;cat&quot;</span>, argv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†å½“å‰çš„æ ‡å‡†è¾“å…¥(fd = 0)æ›¿æ¢ä¸ºéœ€è¦è¯»å…¥çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿå°±æ˜¯å…³é—­å®Œæ ‡å‡†è¾“å…¥(fd = 0)åï¼Œæ­¤æ—¶è°ƒç”¨openï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ä¸º0ã€‚è¿™æ—¶æˆ‘ä»¬å†ä½¿ç”¨å•ä¸ª<code>cat</code>å‘½ä»¤ï¼Œåªä¼šè¯»å–æˆ‘ä»¬æ‰“å¼€çš„æ–‡ä»¶çš„å†…å®¹ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å°†execä¸forkä¸¤ä¸ªæ¥å£åˆ†å¼€</p></blockquote><p>å­è¿›ç¨‹è¿›è¡ŒIOé‡å®šå‘ï¼Œä¸ä¼šå½±å“åˆ°ä¸»è¿›ç¨‹çš„IOè®¾ç½®ã€‚æ ¹æ®caté‡å®šå‘ï¼Œæ ¹æ®ä¸Šè¿°ç¨‹åºï¼Œè‹¥æˆ‘ä»¬åªä½¿ç”¨ä¸€ä¸ªforkexecï¼Œæ²¡æœ‰æ›´æ¢æ ‡å‡†æ–‡ä»¶æè¿°ç¬¦çš„æœºä¼šï¼Œå°±ä¸å¯èƒ½å®ç°IOé‡å®šå‘çš„åŠŸèƒ½ã€‚</p><blockquote><p>ç¡¬ä»¶æ¥å£å ç”¨é—®é¢˜</p></blockquote><p>è™½ç„¶çˆ¶å­è¿›ç¨‹æ‹¥æœ‰éš”ç¦»çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Œä½†æ˜¯çˆ¶å­è¿›ç¨‹å…±ç”¨ç›¸åŒçš„æ–‡ä»¶åç§»é‡ã€‚ä¹Ÿå°±æ˜¯å½“çˆ¶å­è¿›ç¨‹éƒ½ä½¿ç”¨åŒä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œæˆ‘ä»¬æ— æ³•æ§åˆ¶å…¶è¿è¡Œçš„é¡ºåºã€‚ä¾‹å¦‚ï¼šçˆ¶å­è¿›ç¨‹åŒæ—¶ä½¿ç”¨äº†æ ‡å‡†è¾“å‡ºçš„æè¿°ç¬¦ï¼Œè‹¥æ²¡æœ‰waitï¼Œä¼šå‡ºç°<code>world\n hello</code>çš„è¾“å‡º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">&quot;hello &quot;</span>, <span class="number">6</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    wait(<span class="number">0</span>);</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">&quot;world\n&quot;</span>, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ç¨‹åºä¸­æˆ‘ä»¬ä½¿ç”¨äº†wait(0)ï¼Œè®©çˆ¶è¿›ç¨‹å»ç­‰å¾…å­è¿›ç¨‹é€€å‡ºï¼Œä»è€Œæ§åˆ¶äº†æ‰§è¡Œé¡ºåºã€‚</p><blockquote><p>dupæ¥å£ä½¿ç”¨</p></blockquote><p>ä¸Šè¿°ç¨‹åºä½¿ç”¨äº†dupæ¥å£è¿›è¡Œæ”¹å†™ï¼Œå¤åˆ¶çš„fdå¼•ç”¨äº†æ ‡å‡†è¾“å‡º(fd=1)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fd = dup(<span class="number">1</span>);</span><br><span class="line">write(<span class="number">1</span>, <span class="string">&quot;hello &quot;</span>, <span class="number">6</span>);</span><br><span class="line">write(fd, <span class="string">&quot;world\n&quot;</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure><h3 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h3><blockquote><p>xv6ä¸­çš„IOé‡å®šå‘(user/sh.c)</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> REDIR:</span><br><span class="line">  rcmd = (<span class="keyword">struct</span> redircmd*)cmd;</span><br><span class="line">  close(rcmd-&gt;fd);</span><br><span class="line">  <span class="keyword">if</span>(open(rcmd-&gt;file, rcmd-&gt;mode) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;open %s failed\n&quot;</span>, rcmd-&gt;file);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  runcmd(rcmd-&gt;cmd);<span class="comment">//ä½¿ç”¨exce</span></span><br></pre></td></tr></table></figure><h1 id="ç®¡é“-pipe"><a href="#ç®¡é“-pipe" class="headerlink" title="ç®¡é“(pipe)"></a>ç®¡é“(pipe)</h1><h2 id="ç®€ä»‹ï¼š-1"><a href="#ç®€ä»‹ï¼š-1" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h2><p><strong>ç®¡é“ï¼š</strong> æ˜¯ä¸€ä¸ªå°çš„å†…æ ¸ç¼“å†²åŒºæä¾›ç»™è¿›ç¨‹ï¼Œä½œä¸ºä¸€å¯¹æ–‡ä»¶æè¿°ç¬¦ã€‚ä¸€ä¸ªç”¨äºå†™ï¼Œä¸€ä¸ªç”¨äºè¯»ã€‚ç»™ä¸¤ä¸ªç¨‹åºä¸­åˆ›å»ºä¸€ä¸ªé€šè®¯çš„ç®¡é“ï¼Œèƒ½å¤Ÿè¿›è¡Œæ•°æ®äº¤æ¢ã€‚</p><p><strong>ä½œç”¨ï¼š</strong> ç”¨äºä¸åŒè¿›ç¨‹ä¹‹é—´çš„é€šè®¯ï¼Œçœå»äº†ä¸´æ—¶æ–‡ä»¶çš„åˆ›å»ºäºåˆ é™¤ã€‚</p><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>è¯¥ç¨‹åºwc(wordcount),æˆ‘ä»¬å°†æ ‡å‡†è¾“å…¥è¿æ¥åˆ°äº†ç®¡é“çš„è¯»å–ç«¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> p[<span class="number">2</span>];</span><br><span class="line"><span class="type">char</span> *argv[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">argv[<span class="number">0</span>] = <span class="string">&quot;wc&quot;</span>;</span><br><span class="line">argv[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">pipe(p);</span><br><span class="line"><span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">    close(<span class="number">0</span>);</span><br><span class="line">    dup(p[<span class="number">0</span>]);<span class="comment">// å¤åˆ¶ä¸€ä¸ª p[0](ç®¡é“è¯»ç«¯)ï¼Œæ­¤æ—¶æ–‡ä»¶æè¿°ç¬¦ 0ï¼ˆæ ‡å‡†è¾“å…¥ï¼‰ä¹Ÿ</span></span><br><span class="line">            <span class="comment">//å¼•ç”¨ç®¡é“è¯»ç«¯ï¼Œæ•…æ”¹å˜äº†æ ‡å‡†è¾“å…¥ã€‚</span></span><br><span class="line">    close(p[<span class="number">0</span>]);<span class="comment">//å…³é—­äº†æ ‡å‡†è¾“å…¥ï¼ŒåŒæ—¶p[0]ç®¡é“ç«¯ä¹Ÿå¤±æ•ˆ</span></span><br><span class="line">    close(p[<span class="number">1</span>]);<span class="comment">//é˜²æ­¢å­è¿›ç¨‹è‡ªå·±é˜»å¡è‡ªå·±</span></span><br><span class="line">    exec(<span class="string">&quot;/bin/wc&quot;</span>, argv);<span class="comment">// wc ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®(åŒcat)ï¼Œå¹¶å†™å…¥åˆ°</span></span><br><span class="line">                        <span class="comment">// å‚æ•°ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    close(p[<span class="number">0</span>]);</span><br><span class="line">    write(p[<span class="number">1</span>], <span class="string">&quot;hello world\n&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    close(p[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¯¥ç¨‹åºä¸­æˆ‘ä»¬è°ƒç”¨äº†pipe()ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ–°çš„ç®¡é“ï¼Œåœ¨pä¸­è®°å½•ä¸‹äº†æ–‡ä»¶çš„è¯»å†™æè¿°ç¬¦ã€‚çˆ¶å­è¿›ç¨‹éƒ½æ ‡å‡†IOå¼•ç”¨åŒä¸€ç®¡é“</p><ul><li>å­è¿›ç¨‹ä¸­æˆ‘ä»¬closeäº†æ ‡å‡†è¾“å…¥(fd=0)çš„æè¿°ç¬¦ï¼Œä½¿ç”¨dupå¤åˆ¶äº†ç®¡é“è¾“å…¥æè¿°ç¬¦ï¼Œä»è€Œå¼•ç”¨äº†ç®¡é“çš„è¯»å–(è¾“å…¥)ç«¯ã€‚ç®€å•æ¥è¯´å°±æ˜¯<strong>å°†æ ‡å‡†è¾“å…¥æ›¿æ¢æˆäº†ç®¡é“è¾“å…¥</strong>ä¹Ÿå°±æ˜¯é‡å®šå‘ã€‚</li><li>çˆ¶è¿›ç¨‹ä¸­æˆ‘ä»¬å…³é—­äº†æ ‡å‡†è¯»å–(è¾“å…¥)ç®¡é“ï¼Œå°†æ–‡ä»¶å†…å®¹å†™å…¥æ ‡å‡†å†™å…¥(è¾“å‡º)ç®¡é“ï¼Œä»è€Œå°†å†…å®¹å†™å…¥pipeç¼“å†²åŒº</li></ul><p>ç®¡é“æ•°æ®æµå‘å›¾</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="../img/pipe.png" alt="pipe"></p><blockquote><p>çˆ¶è¿›ç¨‹æ¯”å­è¿›ç¨‹æ…¢ä¸€ç‚¹æ‰§è¡Œçš„è¯ï¼Œç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œä¼šä¸ä¼šå¯¼è‡´å­è¿›ç¨‹è¯»å–å¤±è´¥ï¼Ÿ</p></blockquote><p>ç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œä¼šæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p><ul><li><p>ç­‰å¾…å†™å…¥(è¾“å‡º)ç«¯å†™å…¥æ•°æ®ï¼Œè¾“å…¥ç«¯å†è¿›è¡Œè¯»å–(<strong>é˜»å¡</strong>)</p></li><li><p>ç­‰å¾…å¼•ç”¨å†™å…¥(è¾“å‡º)ç«¯çš„ç®¡é“æè¿°ç¬¦è¢«å…³é—­</p></li></ul><p>åœ¨æ‰§è¡Œexecç¨‹åºå‰ï¼Œæ‰§è¡Œ<code>close(p[1])</code>ï¼Œè‹¥æ³¨é‡Šè¯¥è¯­å¥ï¼Œæˆ‘ä»¬å°†ä¸ä¼šæœ‰è¾“å‡ºã€‚<br>wc çš„ä¸€ä¸ªfdä»ç„¶å¼•ç”¨äº†ç®¡é“çš„å†™ç«¯ï¼Œé‚£ä¹ˆ wc å°†æ°¸è¿œçœ‹ä¸åˆ°æ–‡ä»¶çš„å…³é—­ï¼ˆè¢«è‡ªå·±é˜»å¡ï¼‰ã€‚</p><ul><li>è¯»å–ä¸º0ï¼Œå°±åƒè¯»å–åˆ°EOFä¸€æ ·</li></ul><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>åœ¨xv6ä¸­shellå®ç°äº†ç®¡é“ï¼Œå¦‚<code>grep fork sh.c | wc -l</code>ã€‚åˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹åˆ†åˆ«æ‰§è¡Œï¼Œå°†å·¦ç«¯grepè¾“å‡ºçš„å†…å®¹ï¼Œå‘é€ç»™äº†å³ç«¯wcä½œä¸ºå‚æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> PIPE:</span><br><span class="line">   pcmd = (<span class="keyword">struct</span> pipecmd*)cmd;</span><br><span class="line">   <span class="keyword">if</span>(pipe(p) &lt; <span class="number">0</span>)</span><br><span class="line">     panic(<span class="string">&quot;pipe&quot;</span>);</span><br><span class="line">   <span class="keyword">if</span>(fork1() == <span class="number">0</span>)&#123;</span><br><span class="line">     close(<span class="number">1</span>);</span><br><span class="line">     dup(p[<span class="number">1</span>]);</span><br><span class="line">     close(p[<span class="number">0</span>]);</span><br><span class="line">     close(p[<span class="number">1</span>]);</span><br><span class="line">     runcmd(pcmd-&gt;left);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(fork1() == <span class="number">0</span>)&#123;</span><br><span class="line">     close(<span class="number">0</span>);</span><br><span class="line">     dup(p[<span class="number">0</span>]);</span><br><span class="line">     close(p[<span class="number">0</span>]);</span><br><span class="line">     close(p[<span class="number">1</span>]);</span><br><span class="line">     runcmd(pcmd-&gt;right);</span><br><span class="line">   &#125;</span><br><span class="line">   close(p[<span class="number">0</span>]);</span><br><span class="line">   close(p[<span class="number">1</span>]);</span><br><span class="line">   wait(<span class="number">0</span>);</span><br><span class="line">   wait(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/20230201232207.png" alt="xv6-pipe"></p><p>å¦‚å›¾ï¼š</p><ol><li>åˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹(c1ã€c2)ï¼Œåˆ›å»ºç®¡é“è¿æ¥å·¦ç«¯(å†™å…¥ç«¯)å’Œå³ç«¯(è¯»å–ç«¯)</li><li><strong>å·¦ç«¯å†™å…¥ç«¯ï¼š</strong> å­è¿›ç¨‹1ä¸­ï¼Œè¿è¡Œruncmdï¼Œå‘½ä»¤å¦‚grep fork sh.cï¼Œå°†å†…å®¹å†™å…¥buffer</li><li><strong>è¯»å–ç«¯ï¼š</strong> å­è¿›ç¨‹2ä¸­ï¼Œè¿è¡Œruncmdï¼Œå¦‚wc -lï¼Œè¯»å–bufferçš„æ•°æ®</li><li>äº’ç›¸ç­‰å¾…å…¶å®Œæˆï¼Œç®€å•æ¥è¯´ä¸€å†™ä¸€è¯»</li></ol><p>å³ç«¯å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼Œå¦‚<code>a|b|c</code>ï¼Œå…¶ä¸­aä¸ºå†™å…¥ç«¯ï¼Œbã€céƒ½æ˜¯è¯»å–ç«¯ï¼Œbã€céƒ½æ˜¯ä¸¤ä¸ªå­è¿›ç¨‹</p><blockquote><p>Pipeçš„å®é™…ä½œç”¨</p></blockquote><p>ä¸‹è¿°ç¤ºä¾‹ä¸­ç®¡é“é™¤äº†æ²¡æœ‰ä¸´æ—¶æ–‡ä»¶äº§ç”Ÿæ²¡æœ‰ä»€ä¹ˆç”¨é€”äº†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">pipe</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello world | <span class="built_in">wc</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">common:without pipe</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello world &gt;/tmp/xyz; <span class="built_in">wc</span> &lt;/tmp/xyz</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç®¡é“ä¸ä¸´æ—¶æ–‡ä»¶ç›¸æ¯”ä¹Ÿæœ‰ä»¥ä¸‹<strong>ä¼˜åŠ¿</strong></p><ol><li>ç®¡é“ä¼šè‡ªåŠ¨æ¸…ç†è‡ªå·±ï¼›å¦‚æœæ˜¯æ–‡ä»¶é‡å®šå‘ï¼Œshell åœ¨å®Œæˆåå¿…é¡»å°å¿ƒç¿¼ç¿¼åœ°åˆ é™¤/tmp/xyzã€‚</li><li>ç¬¬äºŒï¼Œç®¡é“å¯ä»¥ä¼ é€’ä»»æ„é•¿çš„æ•°æ®æµï¼Œè€Œæ–‡ä»¶é‡å®šå‘åˆ™éœ€è¦ç£ç›˜ä¸Šæœ‰è¶³å¤Ÿçš„ç©ºé—²ç©ºé—´æ¥å­˜å‚¨æ‰€æœ‰æ•°æ®ã€‚</li><li>ç®¡é“å¯ä»¥åˆ†é˜¶æ®µçš„å¹¶è¡Œæ‰§è¡Œï¼Œè€Œæ–‡ä»¶æ–¹å¼åˆ™éœ€è¦åœ¨ç¬¬äºŒä¸ªç¨‹åºå¼€å§‹ä¹‹å‰å®Œæˆç¬¬ä¸€ä¸ªç¨‹åºã€‚</li><li>å¦‚æœä½ è¦å®ç°è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œç®¡é“é˜»å¡è¯»å†™æ¯”æ–‡ä»¶çš„éé˜»å¡è¯­ä¹‰æ›´æœ‰æ•ˆç‡ã€‚</li></ol><h1 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="æ–‡ä»¶ç³»ç»Ÿ-1"><a href="#æ–‡ä»¶ç³»ç»Ÿ-1" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h3><blockquote><p><strong>æ–‡ä»¶ç³»ç»Ÿ</strong></p></blockquote><p>æ“ä½œç³»ç»Ÿä¸­ç”¨äºç®¡ç†ç£ç›˜çš„è½¯ä»¶ï¼Œå¯ä»¥é«˜æ•ˆçš„å°†ç”¨æˆ·åˆ›å»ºçš„æ–‡ä»¶é€šè¿‡I/Oè®¾å¤‡å­˜å‚¨åˆ°ç³»ç»Ÿçš„ç£ç›˜ä¸­ï¼Œä»è€Œå®ç°æŒä¹…åŒ–åœ°å­˜å‚¨æ•°æ®ã€‚</p><blockquote><p><strong>æ–‡ä»¶ç±»å‹</strong></p></blockquote><ul><li>ç›®å½•ï¼šä¿å­˜äº†æ•°æ®æ–‡ä»¶ä¸å…¶ä»–ç›®å½•çš„åç§°å¼•ç”¨ï¼Œç›®å½•æœ¬è´¨ä¸Šä¹Ÿæ˜¯æ–‡ä»¶</li><li>æ•°æ®æ–‡ä»¶ï¼šè¿ç»­çš„å­—èŠ‚æ•°ç»„</li><li>è®¾å¤‡æ–‡ä»¶ï¼šæ‰€æœ‰ç¡¬ä»¶éƒ½æœ‰å¯¹åº”çš„æ–‡ä»¶ï¼Œæ–‡ä»¶ç³»ç»Ÿé€šè¿‡æ–‡ä»¶å»è®¿é—®ç‰¹å®šçš„è®¾å¤‡ã€‚<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/61665350/answer/1700474752">ä»€ä¹ˆæ˜¯è®¾å¤‡æ–‡ä»¶ï¼Ÿ - çŸ¥ä¹</a></li></ul><blockquote><p><strong>æ–‡ä»¶å­˜å‚¨è·¯å¾„</strong></p></blockquote><p>ç›®å½•å’Œæ–‡ä»¶å°†ä¼šå½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„(tree)ã€‚</p><p><code>/</code> ç§°ä¸ºæ ¹(root)ç›®å½•æ˜¯æ‰€æœ‰æ–‡ä»¶çš„å¼€å§‹ç›®å½•ï¼Œä»¥<code>/</code> å¼€å§‹è¡¨ç¤ºçš„è·¯å¾„ç§°ä¸º<strong>ç»å¯¹è·¯å¾„</strong> ï¼Œå¦‚/a/b/cï¼Œä»£è¡¨è®¿é—®åˆ°äº†cè¿™ä¸ªæ–‡ä»¶æˆ–è€…æ˜¯ç›®å½•ã€‚åä¹‹ä¸æ˜¯ä»¥<code>/</code>å¼€å§‹çš„è·¯å¾„ç§°ä¸ºçš„<strong>ç›¸å¯¹è·¯å¾„</strong>ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/20230203190038.png" alt="file_tree"></p><h3 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h3><p>Linux æ–‡ä»¶ç³»ç»Ÿä¼šä¸ºæ¯ä¸ªæ–‡ä»¶åˆ†é…ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼š<strong>ç´¢å¼•èŠ‚ç‚¹ï¼ˆindex nodeï¼‰</strong> å’Œ<strong>ç›®å½•é¡¹ï¼ˆdirectory entryï¼‰</strong>ï¼Œå®ƒä»¬ä¸»è¦ç”¨æ¥è®°å½•æ–‡ä»¶çš„å…ƒä¿¡æ¯å’Œç›®å½•å±‚æ¬¡ç»“æ„ã€‚</p><blockquote><p><strong>ç´¢å¼•èŠ‚ç‚¹(inode)</strong></p></blockquote><p>æ–‡ä»¶ç³»ç»Ÿä¼šç»™ç¡¬ç›˜å†…çš„æ¯ä¸ªæ–‡ä»¶åˆ†é…ä¸€ä¸ªåº•å±‚æ•°æ®ç»“æ„inodeï¼Œæ¯ä¸€ä¸ªinodeçš„ç¼–å·å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨äºä¿å­˜æ–‡ä»¶<strong>å…ƒä¿¡æ¯</strong>ã€‚åœ¨linuxä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨statå‘½ä»¤æŸ¥çœ‹inodeæ¶ˆæ¯ï¼Œinodeæ•°æ®ç»“æ„å­˜åœ¨äºç£ç›˜ä¸­ã€‚</p><p>inodeä¸­çš„<strong>å…ƒä¿¡æ¯(metadata)</strong> å¦‚</p><ul><li>ç´¢å¼•èŠ‚ç‚¹IDï¼šå¯¹åº”æ–‡ä»¶æœ¬èº«</li><li>æ–‡ä»¶çš„å­—èŠ‚æ•°</li><li>æ–‡ä»¶ç±»å‹:æ•°æ®æ–‡ä»¶ã€ç›®å½•ã€è®¾å¤‡æ–‡ä»¶</li><li>é“¾æ¥æ•°ï¼Œå³æœ‰å¤šå°‘æ–‡ä»¶åæŒ‡å‘è¿™ä¸ªinode</li></ul><ul><li>æ–‡ä»¶å†…å®¹åœ¨ç£ç›˜çš„ä½ç½®</li></ul><blockquote><p><strong>ç›®å½•é¡¹(directory entry)</strong> = dentry</p></blockquote><p>ç”¨æ¥è®°å½•æ–‡ä»¶çš„<strong>åå­—</strong>ã€inodeæŒ‡é’ˆä»¥åŠä¸å…¶ä»–dentryçš„å±‚çº§å…³è”å…³ç³»ã€‚å¤šä¸ªdentryå…³è”èµ·æ¥ï¼Œå°±ä¼šå½¢æˆç›®å½•ç»“æ„ï¼Œä½†å®ƒä¸inodeä¸åŒçš„æ˜¯ï¼Œç›®å½•é¡¹æ˜¯ç”±<strong>å†…æ ¸ç»´æŠ¤</strong>çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œ<strong>ä¸å­˜æ”¾äºç£ç›˜</strong>ï¼Œè€Œæ˜¯ç¼“å­˜åœ¨å†…å­˜ã€‚</p><p>ç”±äºinodeå”¯ä¸€æ ‡è¯†ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œdentryè®°å½•ç€æ–‡ä»¶çš„åç§°ï¼Œæ‰€ä»¥ç›®å½•é¡¹å’Œç´¢å¼•èŠ‚ç‚¹çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªåç§°ã€‚</p><blockquote><p>ç¡¬ç›˜å­˜å‚¨æ•°æ®</p></blockquote><p>ç£ç›˜è¯»å†™çš„æœ€å°å•ä½æ˜¯æ‰‡åŒºï¼Œæ‰‡åŒºçš„å¤§å°åªæœ‰ 512B å¤§å°ï¼Œå¦‚æœæ¯æ¬¡è¯»å†™éƒ½ä»¥è¿™ä¹ˆå°ä¸ºå•ä½ï¼Œé‚£è¿™è¯»å†™çš„æ•ˆç‡ä¼šéå¸¸ä½ã€‚</p><p>æ‰€ä»¥ï¼Œæ–‡ä»¶ç³»ç»ŸæŠŠå¤šä¸ªæ‰‡åŒºç»„æˆäº†ä¸€ä¸ªé€»è¾‘å—ï¼Œæ¯æ¬¡è¯»å†™çš„æœ€å°å•ä½å°±æ˜¯é€»è¾‘å—ï¼ˆæ•°æ®å—ï¼‰ï¼ŒLinux ä¸­çš„é€»è¾‘å—å¤§å°ä¸º 4KBï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æ€§è¯»å†™ 8 ä¸ªæ‰‡åŒºï¼Œè¿™å°†å¤§å¤§æé«˜äº†ç£ç›˜çš„è¯»å†™çš„æ•ˆç‡ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯ç´¢å¼•èŠ‚ç‚¹ã€ç›®å½•é¡¹ä»¥åŠæ–‡ä»¶æ•°æ®çš„å…³ç³»ï¼Œä¸‹é¢è¿™ä¸ªå›¾å°±å¾ˆå¥½çš„å±•ç¤ºäº†å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/20230203180037.png" alt="inode and entry"></p><blockquote><p>inodeæ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„æ•°æ®ï¼Œé‚£ä¹ˆä¸ºäº†åŠ é€Ÿæ–‡ä»¶çš„è®¿é—®ï¼Œé€šå¸¸ä¼šæŠŠinodeåŠ è½½åˆ°å†…å­˜ä¸­</p></blockquote><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/183238194">å°æ—coding</a></p><h2 id="æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼šxv6"><a href="#æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼šxv6" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼šxv6"></a>æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼šxv6</h2><div class="table-container"><table><thead><tr><th>ç³»ç»Ÿè°ƒç”¨</th><th>æè¿°</th></tr></thead><tbody><tr><td>int <code>chdir(char *dir)</code></td><td>Change the current directory.</td></tr><tr><td>int <code>mkdir(char *dir)</code></td><td>Create a new directory.</td></tr><tr><td>int <code>mknod(char *file, int, int)</code></td><td>Create a device file.</td></tr><tr><td>int <code>fstat(int fd, struct stat *st)</code></td><td>Place info about an open file into <code>*st</code>.</td></tr><tr><td>int <code>stat(char *file, struct stat *st)</code></td><td>Place info about a named file into <code>*st.</code></td></tr><tr><td>int <code>link(char *file1, char *file2)</code></td><td>Create another name (file2) for the file file1.</td></tr><tr><td>int <code>unlink(char *file)</code></td><td>Remove a file.</td></tr></tbody></table></div><ul><li><p>cddir: åˆ‡æ¢å½“å‰æ–‡ä»¶ç›®å½•ï¼ŒåŒcdå‘½ä»¤</p></li><li><p>mkdir: åˆ›å»ºç›®å½•ï¼ŒåŒlinuxä¸‹çš„mkdirå‘½ä»¤</p></li><li><p>mknod: åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯¹è®¾å¤‡æ–‡ä»¶è¿›è¡Œå¼•ç”¨ï¼Œä¸è®¾å¤‡æ–‡ä»¶ç›¸å…³çš„æ˜¯ä¸»è¦å’Œæ¬¡è¦è®¾å¤‡ç¼–å·ï¼ˆmknodçš„ä¸¤ä¸ªå‚æ•°ï¼‰ï¼Œå®ƒä»¬å”¯ä¸€åœ°æ ‡è¯†å†…æ ¸è®¾å¤‡ã€‚</p></li><li><p>link:åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åï¼Œå¯¹ç›¸åŒçš„inodeè¿›è¡Œå¼•ç”¨ä½œä¸ºä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶</p><h2 id="åº”ç”¨ç¤ºä¾‹-2"><a href="#åº”ç”¨ç¤ºä¾‹-2" class="headerlink" title="åº”ç”¨ç¤ºä¾‹"></a>åº”ç”¨ç¤ºä¾‹</h2></li><li><p>chdirä¸open</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*---ä½¿ç”¨chdiræ”¹å˜å½“å‰ç›®å½•ï¼Œä»¥ç›¸å¯¹è·¯å¾„åˆ›å»ºæ–‡ä»¶---*/</span></span><br><span class="line">chdir(<span class="string">&quot;/a&quot;</span>);</span><br><span class="line">chdir(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">open(<span class="string">&quot;c&quot;</span>, O_RDONLY);</span><br><span class="line"><span class="comment">/*---ä»¥ç»å¯¹è·¯å¾„åˆ›å»ºæ–‡ä»¶---*/</span></span><br><span class="line">open(<span class="string">&quot;/a/b/c&quot;</span>, O_RDONLY);</span><br></pre></td></tr></table></figure></li><li><p>mkdirä¸mknod</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºdiræ–‡ä»¶å¤¹ï¼Œå¹¶ä»¥åªå†™çš„æ–¹å¼åˆ›å»ºfileæ–‡ä»¶*/</span></span><br><span class="line">mkdir(<span class="string">&quot;/dir&quot;</span>);</span><br><span class="line">fd = open(<span class="string">&quot;/dir/file&quot;</span>, O_CREATE|O_WRONLY);</span><br><span class="line">close(fd);</span><br><span class="line"><span class="comment">/*åˆ›å»ºconsoleè®¾å¤‡æ–‡ä»¶*/</span></span><br><span class="line">mknod(<span class="string">&quot;/console&quot;</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><blockquote><p>åˆ›å»ºè®¾å¤‡æ–‡ä»¶åï¼Œå†…æ ¸å›å°†è¯»å†™çš„ç³»ç»Ÿè°ƒç”¨è½¬ç§»åˆ°å†…æ ¸è®¾å¤‡ï¼Œè€Œä¸æ˜¯ä¼ é€’ç»™æ–‡ä»¶ç³»ç»Ÿ</p></blockquote></li><li><p>linkä¸unlink</p><blockquote><p><strong>é“¾æ¥(link)ï¼š</strong> æ¯ä¸ªé“¾æ¥ç”±ç›®å½•ä¸­çš„æ¡ç›®ä¹Ÿå°±æ˜¯(dentry)ç»„æˆï¼Œdentryå†…å®¹åŒ…å«æ–‡ä»¶åä¸å¼•ç”¨çš„inode</p></blockquote></li></ul><p>å¦‚ä¸‹ï¼Œåˆ›å»ºbçš„æ–‡ä»¶è¿›è¡Œè¯»å†™å’Œå¯¹aè¿›è¡Œè¯»å†™çš„æ•ˆæœç›¸åŒï¼Œå¯¹aã€bæ–‡ä»¶ä½¿ç”¨statå‘½ä»¤è¿›è¡Œè§‚å¯Ÿï¼Œå¯ä»¥è§‚æµ‹åˆ°aã€bæœ‰ç›¸åŒçš„inodeå·ä¸ä¸€æ ·çš„é“¾æ¥æ•°(nlink) =2ã€‚å½“ä½¿ç”¨unlinkåï¼Œæˆ‘ä»¬å†è§‚æµ‹bæ–‡ä»¶ä¼šè¿”ç°nlink=0</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*åˆ›å»ºä¸€ä¸ªæ–‡ä»¶aï¼Œåˆ›å»ºbæ–‡ä»¶å¯¹aè¿›è¡Œé“¾æ¥*/</span></span><br><span class="line">open(<span class="string">&quot;a&quot;</span>, O_CREATE|O_WRONLY);</span><br><span class="line">link(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>)</span><br><span class="line"><span class="comment">/*å–æ¶ˆaæ–‡ä»¶çš„é“¾æ¥*/</span></span><br><span class="line">unlink(<span class="string">&quot;a&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®ç»“æ„-xv6"><a href="#æ•°æ®ç»“æ„-xv6" class="headerlink" title="æ•°æ®ç»“æ„(xv6)"></a>æ•°æ®ç»“æ„(xv6)</h2><ul><li><p>fstatç³»ç»Ÿè°ƒç”¨æ£€ç´¢inodeçš„æ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯ï¼Œå¹¶å°†å…¶å¡«å…¥statç»“æ„ä½“ä¸­å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> T_DIR     1   <span class="comment">// Directory</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> T_FILE    2   <span class="comment">// File</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> T_DEVICE  3   <span class="comment">// Device</span></span></span><br></pre></td></tr></table></figure></li></ul><p>struct stat {<br>int dev; // File systemâ€™s disk device<br>uint ino; // Inode number<br>short type; // Type of file<br>short nlink; // Number of links to file<br>uint64 size; // Size of file in bytes<br>};</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- cdå‘½ä»¤æ”¹å˜shellå½“å‰çš„å·¥ä½œç›®å½•ï¼Œå¦‚æœcdä½œä¸ºæ™®é€šå‘½ä»¤æ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä¼šforkä¸€ä¸ªå­è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹åªä¼šæ”¹å˜å½“å‰ç›®å½•ï¼Œä¸ä¼šè¯¥æ”¹å˜çˆ¶è¿›ç¨‹ç›®å½•ã€‚ä»¥æ­¤ä¸éœ€è¦forkä¸€ä¸ªè¿›ç¨‹å»ä¿®æ”¹ç›®å½•ã€‚</span><br><span class="line">```c</span><br><span class="line">  // Read and run input commands.</span><br><span class="line">  while(getcmd(buf, sizeof(buf)) &gt;= 0)&#123;</span><br><span class="line">    if(buf[0] == &#x27;c&#x27; &amp;&amp; buf[1] == &#x27;d&#x27; &amp;&amp; buf[2] == &#x27; &#x27;)&#123;</span><br><span class="line">      // Chdir must be called by the parent, not the child.</span><br><span class="line">      buf[strlen(buf)-1] = 0;  // chop \n</span><br><span class="line">      //buf+3(&quot;cd &quot;) &#x27;+3&#x27;meanning skip to the string for dir</span><br><span class="line">      if(chdir(buf+3) &lt; 0)</span><br><span class="line">        fprintf(2, &quot;cannot cd %s\n&quot;, buf+3);</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line">    if(fork1() == 0)</span><br><span class="line">      runcmd(parsecmd(buf));</span><br><span class="line">    wait(0);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬ç« ä¸»è¦æ˜¯è®²è§£äº†ç³»ç»Ÿè°ƒç”¨çš„ä¸€äº›æ¥å£ï¼Œå¹¶ä¸”ç®€å•çš„ä»‹ç»äº†ä¸€äº›linuxçš„å¸¸è¯†ã€‚æœ¬èŠ‚è¯¾ä¹Ÿæœ‰å¯¹åº”çš„å®éªŒï¼Œå¯ä»¥è®©ä½ å»å®ç°ä¸€äº›å¸¸ç”¨linuxçš„å·¥å…·<a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.828/2022/labs/util.html">lab1</a>(å…¶ä¸­ååˆ†æœ‰è¶£çš„å®éªŒç”¨pipeå»å®ç°æµæ°´çº¿)ã€‚</p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>xv6ï¼šæ“ä½œç³»ç»Ÿæ¥å£</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="http://www.ember-l.top/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%201%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/">http://www.ember-l.top/2023/03/14/æ“ä½œç³»ç»Ÿ/Chapter 1ï¼šæ“ä½œç³»ç»Ÿæ¥å£/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>EmberğŸ</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-03-14</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-09-26</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a></div><div class="post_share"><div class="social-share" data-image="https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload='this.media="all"'><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload='this.media="all"'><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ç¡¬å¸</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.jpg" alt="wechat"></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/alipay.jpg" alt="alipay"></a><div class="post-qr-code-desc">alipay</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%202%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img40.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">xv6ï¼šæ“ä½œç³»ç»Ÿç»„æˆ</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/14/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C/Debug/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img38.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Debugging by Pretty Printing</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%202%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90/" title="xv6ï¼šæ“ä½œç³»ç»Ÿç»„æˆ"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img40.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-14</div><div class="title">xv6ï¼šæ“ä½œç³»ç»Ÿç»„æˆ</div></div></a></div><div><a href="/2023/03/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%203%EF%BC%9A%E9%A1%B5%E8%A1%A8/" title="xv6ï¼šé¡µè¡¨"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img32.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-14</div><div class="title">xv6ï¼šé¡µè¡¨</div></div></a></div><div><a href="/2023/05/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%204%EF%BC%9A%E9%99%B7%E9%98%B1%20trap/" title="xv6ï¼štrapæœºåˆ¶"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-14</div><div class="title">xv6ï¼štrapæœºåˆ¶</div></div></a></div><div><a href="/2023/06/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%205%EF%BC%9A%E4%B8%AD%E6%96%AD%E4%B8%8E%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8/" title="xv6ï¼šä¸­æ–­ä¸è®¾å¤‡é©±åŠ¨"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/Console%EF%BC%9Aoutput.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-14</div><div class="title">xv6ï¼šä¸­æ–­ä¸è®¾å¤‡é©±åŠ¨</div></div></a></div><div><a href="/2023/09/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%208%EF%BC%9A%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/layers.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-25</div><div class="title">xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ</div></div></a></div><div><a href="/2023/04/24/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/lab/Lab2%EF%BC%9Asyscall/" title="Mit6.S081:lab syscall"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img38.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-24</div><div class="title">Mit6.S081:lab syscall</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author_top is-center"><div class="card-info-avatar"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/assets/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="palm_tree" fallback-src="https://lskypro.acozycotage.net/LightPicture/2022/12/fe1dc0402e623096.jpg">ğŸŸ</g-emoji><span>è®¤çœŸæ‘¸é±¼ä¸­</span></div></div></div><div class="author-info__name">EmberğŸ</div><div class="author-info__description">BugMaker ğŸ’¦ğŸ’¦ğŸ’¦</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ember-l"><i></i><span>Follow meğŸš€</span></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="/assets/qq.jpg" target="_blank" title="QQ"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/assets/wx.jpg" target="_blank" title="å¾®ä¿¡"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-weixin"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://github.com/ember-l" target="_blank" title="github"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github1"></use></svg></a><a class="social-icon faa-parent animated-hover" href="mailto:2508856440@qq.com" target="_blank" title="é‚®ç®±"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://www.zhihu.com/people/low-45-75" target="_blank" title="çŸ¥ä¹"><svg class="social_icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shejiaotubiao-10"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a class="faa-parent animated-hover"><svg class="faa-tada icon" style="height:27px;width:27px;fill:currentColor;position:relative;top:3px" aria-hidden="true"><use xlink:href="#icon-fengche"></use></svg></a><span>å…¬å‘Š</span></div><div class="announcement_content"><center><b>--- ä¸»åŸŸå ---<br><a href="https://www.ember-l.top" title="æ­¤çº¿è·¯éƒ¨ç½²äºVercel" class="anno_content"><font color="#cc7227">ember-l.top</font></a></b></center></div><div id="welcome-info"></div></div><div class="card-widget tzy-right-widget" id="card-wechat"><div id="flip-wrapper"><div id="flip-content"><div class="face"></div><div class="back face"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><a class="faa-parent animated-hover"><svg class="faa-tada icon" style="height:27px;width:27px;fill:currentColor;position:relative;top:3px" aria-hidden="true"><use xlink:href="#icon-mulu"></use></svg></a><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="toc-text">ç³»ç»Ÿè°ƒç”¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E4%B8%8E%E5%86%85%E5%AD%98"><span class="toc-text">è¿›ç¨‹ä¸å†…å­˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B-Process-%EF%BC%9A"><span class="toc-text">è¿›ç¨‹(Process)ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%EF%BC%9Axv6"><span class="toc-text">è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨ï¼šxv6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">åº”ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%88%9B%E5%BB%BA-%E7%BB%86%E8%8A%82"><span class="toc-text">è¿›ç¨‹åˆ›å»º(ç»†èŠ‚)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-xv6"><span class="toc-text">è¿›ç¨‹çš„æ•°æ®ç»“æ„(xv6)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#I-O-%E4%B8%8E-%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-text">I&#x2F;O ä¸ æ–‡ä»¶æè¿°ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B%EF%BC%9A"><span class="toc-text">ç®€ä»‹ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I-O%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%EF%BC%9Axv6"><span class="toc-text">I&#x2F;Oç³»ç»Ÿè°ƒç”¨ï¼šxv6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B-1"><span class="toc-text">åº”ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I-O%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">I&#x2F;Oé‡å®šå‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%86%E8%8A%82"><span class="toc-text">ç»†èŠ‚</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%A1%E9%81%93-pipe"><span class="toc-text">ç®¡é“(pipe)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B%EF%BC%9A-1"><span class="toc-text">ç®€ä»‹ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-text">ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E9%80%94"><span class="toc-text">ç”¨é€”</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-text">æ–‡ä»¶ç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-1"><span class="toc-text">æ–‡ä»¶ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-text">æ–‡ä»¶ç»“æ„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%EF%BC%9Axv6"><span class="toc-text">æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨ï¼šxv6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B-2"><span class="toc-text">åº”ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-xv6"><span class="toc-text">æ•°æ®ç»“æ„(xv6)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/13/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/IO%E5%A4%8D%E7%94%A8/" title="I/Oå¤ç”¨è¯¦è§£"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/epoll_linux.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="I/Oå¤ç”¨è¯¦è§£"></a><div class="content"><a class="title" href="/2024/07/13/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/IO%E5%A4%8D%E7%94%A8/" title="I/Oå¤ç”¨è¯¦è§£">I/Oå¤ç”¨è¯¦è§£</a><time datetime="2024-07-13T06:15:00.000Z" title="å‘è¡¨äº 2024-07-13 14:15:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/06/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="Socketç½‘ç»œç¼–ç¨‹åŸºç¡€"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/socketAPI.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Socketç½‘ç»œç¼–ç¨‹åŸºç¡€"></a><div class="content"><a class="title" href="/2023/12/06/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="Socketç½‘ç»œç¼–ç¨‹åŸºç¡€">Socketç½‘ç»œç¼–ç¨‹åŸºç¡€</a><time datetime="2023-12-06T06:15:00.000Z" title="å‘è¡¨äº 2023-12-06 14:15:00">2023-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%208%EF%BC%9A%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/layers.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ"></a><div class="content"><a class="title" href="/2023/09/25/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Chapter%208%EF%BC%9A%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ">xv6ï¼šæ–‡ä»¶ç³»ç»Ÿ</a><time datetime="2023-09-24T16:00:00.000Z" title="å‘è¡¨äº 2023-09-25 00:00:00">2023-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/26/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/lab/Lab10%EF%BC%9Ammap/" title="Mit6.S081:lab mmap"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/image-20230726141038789.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Mit6.S081:lab mmap"></a><div class="content"><a class="title" href="/2023/07/26/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/lab/Lab10%EF%BC%9Ammap/" title="Mit6.S081:lab mmap">Mit6.S081:lab mmap</a><time datetime="2023-07-25T16:00:00.000Z" title="å‘è¡¨äº 2023-07-26 00:00:00">2023-07-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/07/17/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/lab/Lab9%EF%BC%9Afs/" title="Mit6.S081:lab fs"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/2level_inode.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Mit6.S081:lab fs"></a><div class="content"><a class="title" href="/2023/07/17/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/lab/Lab9%EF%BC%9Afs/" title="Mit6.S081:lab fs">Mit6.S081:lab fs</a><time datetime="2023-07-16T16:00:00.000Z" title="å‘è¡¨äº 2023-07-17 00:00:00">2023-07-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By EmberğŸ</div><div class="footer_custom_text"><a href="https://icp.gov.moe/?keyword=20232016" target="_blank">èŒICPå¤‡20232016å·</a><p>There is only one heroism in the world to see the world as it is and to love it</p><p><a target="_blank" href="https://hexo.io/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸ºHexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"></a>&nbsp;<a target="_blank" href="https://vercel.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œè”é€šçº¿è·¯æ‰˜ç®¡äºCoding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/node-snackbar/0.1.16/snackbar.min.js"></script><script src="https://cdn.staticfile.org/algoliasearch/4.14.3/algoliasearch-lite.umd.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.49.0/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{const e=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.ember-l.top/.netlify/functions/twikoo",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)")),setTimeout((function(){let e=document.querySelectorAll(".tk-comments-container .tk-comment");if(e.length>0){let n='<div class="swiper-wrapper">';for(let t=0;t<e.length;t++){let o=e[t].getAttribute("id")||"",a=e[t].querySelector(".tk-nick")?.innerText||"",i=e[t].querySelector(".tk-nick")?.href||"",r=e[t].querySelector(".tk-avatar-img")?.src||"",l=e[t].querySelector(".tk-time")?.innerText||"",c=e[t].querySelector(".tk-extras .tk-extra:first-child span:last-child")?.innerText||"",s=e[t].querySelector(".tk-content>span:last-child")?.innerHTML||"";s=s.replace(/\n/g,""),s=s.replace(/<blockquote>.*?<\/blockquote>/gi,""),s=s.replace(/<pre.*?<\/pre>/gi,"[ä»£ç ]"),n+=`\n                <div class="swiper-slide">\n                  <div class="comment-barrage-item">\n                    <div class="barrage-info">\n                      <a class="barrage-title" title="è·³è½¬è‡³è¯„è®ºåŒº" href="#post-comment">çƒ­è¯„</a>\n                      <a href="${i?i+'" target="_blank" rel="noopener noreferrer" title="è®¿é—® '+a+'"':'javascript:void(0);"'}>\n                        <img class="barrage-avatar" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="${r}">\n                      </a>\n                      <span class="barrage-nick">${a}</span>\n                      <span class="barrage-city">${c}</span>\n                      <span class="barrage-time">${l}</span>\n                      <a class="barrage-close" onclick="eurkon.switchCommentBarrage()" title="éšè—çƒ­è¯„"><i class="fa-solid fa-xmark"></i></a>\n                    </div>\n                    <div class="barrage-content">\n                      <a title="è·³è½¬è‡³è¯¥è¯„è®º" href="#${o}">${s}</a>\n                    </div>\n                  </div>\n                </div>`}n+="</div>";let o=document.getElementById("comment-barrage")||document.createElement("div");o.id="comment-barrage",o.innerHTML=n,o.style.display="false"===window.localStorage.getItem("commentBarrageDisplay")?"none":"block",document.getElementById("post-comment").appendChild(o);var t=new Swiper("#comment-barrage",{direction:"vertical",loop:!0,mousewheel:!0,autoplay:{delay:3e3,disableOnInteraction:!0}});o.onmouseenter=function(){t.autoplay.stop()},o.onmouseleave=function(){t.autoplay.start()}}}),1e3)}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const e=document.getElementById("twikoo-count");e&&twikoo.getCommentsCount({envId:"https://twikoo.ember-l.top/.netlify/functions/twikoo",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(t){e.innerText=t[0].count})).catch((function(e){console.error(e)}))})()},t=()=>{"object"!=typeof twikoo?getScript("https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js").then(e):setTimeout(e,0)};btf.loadComment(document.getElementById("twikoo-wrap"),t)})()</script></div><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script src="/js/share.js"></script><script src="/js/key.js"></script><script src="/js/barrage.js"></script><script defer src="/js/light.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="//at.alicdn.com/t/c/font_3864328_90xjkz8cfrn.js"></script><script async src="/js/fps.js"></script><script src="/js/nav.js" async></script><script src="/js/sun_moon.js" async></script><script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async data-pjax src="/js/txmap.js"></script><script src="/js/charts.js" async></script><script defer data-pjax src="/js/beautify.js"></script><script src="/js/twikoo_beautify.js"></script><script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script>LA.init({id:"Jx18u1PbLX8sXMaz",ck:"Jx18u1PbLX8sXMaz"})</script><script>(new LingQue.Monitor).init({id:"Jx18u1PbLX8sXMaz",sendSuspicious:!0})</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/fireworks.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/butterfly-extsrc/1.1.3/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"===location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="http://www.ember-l.top/categories/MIT6-824/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“š é˜¿æ¢¨ã®åˆ†å¸ƒå¼ç³»ç»Ÿå­¦ä¹  (7)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://www.ember-l.top/categories/C/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ® é˜¿æ¢¨ã®C++å­¦ä¹  (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://www.ember-l.top/categories/æ“ä½œç³»ç»Ÿ/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ± é˜¿æ¢¨ã®æ“ä½œç³»ç»Ÿå­¦ä¹  (16)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="http://www.ember-l.top/categories/Tool/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“’ é˜¿æ¢¨ã®å¸¸ç”¨å·¥å…· (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="http://www.ember-l.top/categories" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';console.log("å·²æŒ‚è½½magnet"),parent.insertAdjacentHTML("afterbegin",child)}</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(50% - 5px);background:#f2f2f2;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#fed558}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><script data-pjax>function butterfly_swiper_injector_config(){var a=document.getElementById("recent-posts");console.log("å·²æŒ‚è½½butterfly_swiper"),a.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/20/åˆ†å¸ƒå¼ç³»ç»Ÿ/FaRMè®ºæ–‡ç¬”è®°/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/FaRM1.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/20/åˆ†å¸ƒå¼ç³»ç»Ÿ/FaRMè®ºæ–‡ç¬”è®°/&quot;);" href="javascript:void(0);" alt="">FaRM</a><div class="blog-slider__text">No compromises:distributed transactions with consistency, availability, and performance</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/20/åˆ†å¸ƒå¼ç³»ç»Ÿ/FaRMè®ºæ–‡ç¬”è®°/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/07/17/æ“ä½œç³»ç»Ÿ/lab/Lab9ï¼šfs/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/2level_inode.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-07-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/07/17/æ“ä½œç³»ç»Ÿ/lab/Lab9ï¼šfs/&quot;);" href="javascript:void(0);" alt="">Mit6.S081:lab fs</a><div class="blog-slider__text">MIT6.S081ï¼šlab9</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/07/17/æ“ä½œç³»ç»Ÿ/lab/Lab9ï¼šfs/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/07/26/æ“ä½œç³»ç»Ÿ/lab/Lab10ï¼šmmap/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/image-20230726141038789.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-07-26</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/07/26/æ“ä½œç³»ç»Ÿ/lab/Lab10ï¼šmmap/&quot;);" href="javascript:void(0);" alt="">Mit6.S081:lab mmap</a><div class="blog-slider__text">MIT6.S081ï¼šlab10</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/07/26/æ“ä½œç³»ç»Ÿ/lab/Lab10ï¼šmmap/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Sharded KV Service/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img21.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Sharded KV Service/&quot;);" href="javascript:void(0);" alt="">Lab4:Shards KV Service(æœªå®Œå–„)</a><div class="blog-slider__text">MIT6.824 lab4å®ç°# æè¿°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Sharded KV Service/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/12/06/ç½‘ç»œç¼–ç¨‹/socketç½‘ç»œç¼–ç¨‹/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/socketAPI.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/12/06/ç½‘ç»œç¼–ç¨‹/socketç½‘ç»œç¼–ç¨‹/&quot;);" href="javascript:void(0);" alt="">Socketç½‘ç»œç¼–ç¨‹åŸºç¡€</a><div class="blog-slider__text">socketç½‘ç»œç¼–ç¨‹åŸºç¡€å…¥é—¨</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/12/06/ç½‘ç»œç¼–ç¨‹/socketç½‘ç»œç¼–ç¨‹/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/13/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/KVRaft/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/202301251415687.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/13/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/KVRaft/&quot;);" href="javascript:void(0);" alt="">Lab:KVRaft</a><div class="blog-slider__text">MIT6.824 lab3å®ç°# æè¿°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/13/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/KVRaft/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/05/14/æ“ä½œç³»ç»Ÿ/Chapter 4ï¼šé™·é˜± trap/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img31.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/05/14/æ“ä½œç³»ç»Ÿ/Chapter 4ï¼šé™·é˜± trap/&quot;);" href="javascript:void(0);" alt="">xv6ï¼štrapæœºåˆ¶</a><div class="blog-slider__text">MITï¼šxv6 chapter4</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/05/14/æ“ä½œç³»ç»Ÿ/Chapter 4ï¼šé™·é˜± trap/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/03/14/æ“ä½œç³»ç»Ÿ/Chapter 3ï¼šé¡µè¡¨/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img32.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/03/14/æ“ä½œç³»ç»Ÿ/Chapter 3ï¼šé¡µè¡¨/&quot;);" href="javascript:void(0);" alt="">xv6ï¼šé¡µè¡¨</a><div class="blog-slider__text">MITï¼šxv6 chapter3</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/03/14/æ“ä½œç³»ç»Ÿ/Chapter 3ï¼šé¡µè¡¨/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Debug/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/img38.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Debug/&quot;);" href="javascript:void(0);" alt="">Debugging by Pretty Printing</a><div class="blog-slider__text">Lab2ï¼šRaftç¾åŒ–è°ƒè¯•å·¥å…·é…ç½®æ–¹æ³•</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/03/14/åˆ†å¸ƒå¼ç³»ç»Ÿ/å®éªŒ/Debug/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2024/07/13/ç½‘ç»œç¼–ç¨‹/IOå¤ç”¨/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ember-img.oss-cn-chengdu.aliyuncs.com/epoll_linux.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2024/07/13/ç½‘ç»œç¼–ç¨‹/IOå¤ç”¨/&quot;);" href="javascript:void(0);" alt="">I/Oå¤ç”¨è¯¦è§£</a><div class="blog-slider__text">I/Oå¤ç”¨æ¨¡å‹è®²è§£</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2024/07/13/ç½‘ç»œç¼–ç¨‹/IOå¤ç”¨/&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","1s"),arr[i].setAttribute("data-wow-delay","700ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script></body></html>